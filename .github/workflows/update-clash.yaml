name: Auto Merge Clash Config

on:
  schedule:
    - cron: '0 2 * * *'  # æ¯å¤© UTC æ—¶é—´ 2 ç‚¹æ‰§è¡Œ
  workflow_dispatch:      # æ”¯æŒæ‰‹åŠ¨è§¦å‘

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v3

      - name: è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: å®‰è£…ä¾èµ–
        run: pip install requests pyyaml

      - name: è¿è¡Œåˆå¹¶è„šæœ¬
        run: python scripts/merge.py

      - name: æäº¤å¹¶æ¨é€æ›´æ”¹
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add merged_clash.yaml
          git commit -m "ğŸ¤– è‡ªåŠ¨æ›´æ–°  é…ç½® $(date '+%Y-%m-%d %H:%M:%S')" || echo "æ— æ›´æ”¹"
          git push
